(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["sparePart"],{6397:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"spare-part"},[r("div",{staticClass:"main-content-end"},[r("a",{attrs:{href:"/pvams/component/export/"+t.stationId}},[r("el-button",{attrs:{type:"",size:"small"}},[t._v("导出模板")])],1),t.getUserJurisdiction("AT27")?r("el-upload",{staticClass:"upload-demo",style:{marginLeft:"20px"},attrs:{action:"/pvams/component/import/"+t.stationId,"on-success":function(e){return t.uploadSuccess(e)},"show-file-list":!1,"before-upload":function(e){return t.beforeAvatarUpload(e)}}},[r("el-button",{attrs:{size:"small",type:"primary"}},[t._v("导入信息")])],1):t._e()],1),r("div",{staticClass:"table",style:{marginTop:"20px"}},[r("el-table",{attrs:{"header-cell-class-name":"table-th",data:t.tableList,border:"",stripe:""}},[t._l(t.columns,function(t,e){return r("el-table-column",{key:e,attrs:{align:"center",prop:t.prop,label:t.label,width:t.width}})}),r("el-table-column",{attrs:{label:"操作",width:"160px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return t.clickConfirm(e.row,0)}}},[t._v("领用")]),r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return t.clickConfirm(e.row,1)}}},[t._v("入库")]),r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return t.clickRecord(e.row,1)}}},[t._v("记录查询")])]}}])})],2)],1),r("div",[r("el-pagination",{attrs:{align:"right",small:"","page-size":10,layout:"prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),r("div",{staticClass:"dialog"},[r("el-dialog",{attrs:{title:"记录查询",visible:t.isVisibleQuery,width:"62%"},on:{"update:visible":function(e){t.isVisibleQuery=e}}},[r("div",{staticClass:"main"},[r("el-table",{attrs:{data:t.recordDataList,border:"",stripe:""}},[t._l(t.recordColumns,function(t,e){return r("el-table-column",{key:e,attrs:{align:"center",prop:t.prop,label:t.label,width:t.width}})}),r("el-table-column",{attrs:{label:"领用状态",align:"center",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(0===e.row.action?"领取":"入库")+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"审批状态",align:"center",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(0===e.row.status?"待确认":1===e.row.status?"已确认":2===e.row.status?"驳回":"")+"\n            ")]}}])}),t.getUserJurisdiction("AT28")?r("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status?t._e():r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return t.clickQueryConfirm(e.row,1)}}},[t._v("确认")]),e.row.status?t._e():r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return t.clickQueryConfirm(e.row,2)}}},[t._v("驳回")])]}}],null,!1,1668070183)}):t._e()],2)],1),r("div",[r("el-pagination",{attrs:{align:"right",small:"","page-size":10,layout:"prev, pager, next",total:t.recordTotal},on:{"current-change":function(e){return t.handleCurrentChange(e,2)}}})],1)]),r("el-dialog",{attrs:{title:"",visible:t.isShowDialog,width:"30%"},on:{"update:visible":function(e){t.isShowDialog=e},close:function(e){return t.close("collarForm")}}},[r("div",{staticClass:"main"},[r("el-form",{ref:"collarForm",attrs:{model:t.collarForm,size:"small","label-width":"100px"}},[r("el-form-item",{attrs:{label:"数量：",prop:"num",rules:[{required:!0,message:"请输入数量"},{pattern:/^\d/,message:"只能输入数值"}]}},[r("el-input",{model:{value:t.collarForm.num,callback:function(e){t.$set(t.collarForm,"num",t._n(e))},expression:"collarForm.num"}})],1)],1)],1),r("div",{attrs:{slot:"footer",align:"center"},slot:"footer"},[r("el-button",{on:{click:function(e){t.isShowDialog=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.clickCollarConfirm("collarForm")}}},[t._v("确 定")])],1)])],1)])},i=[],n=r("cebc"),s=(r("96cf"),r("3b8d")),o=(r("6762"),r("2fdb"),r("bfe6")),l={mixins:[o["a"]],data:function(){return{tableList:[],stationId:"",columns:[{label:"备件名称",width:"",prop:"componentName"},{label:"数量",width:"",prop:"num"},{label:"品牌",width:"",prop:"brand"},{label:"库存上限",width:"",prop:"stockUp"},{label:"库存下限",width:"",prop:"stockLower"},{label:"参数",width:"",prop:"param"}],total:0,collarForm:{},pageSize1:1,pageSize2:1,recordTotal:0,recordId:"",isShowDialog:!1,isVisibleQuery:!1,recordDataList:[],recordColumns:[{label:"申请人",width:"",prop:"applyer"},{label:"提交日期",width:"160px",prop:"submitDate"},{label:"数量",width:"",prop:"num"},{label:"审批人",width:"",prop:"approver"},{label:"审批日期",width:"160px",prop:"approveDate"}],status:[{label:"领取",value:0},{label:"入库",value:1}]}},created:function(){this.userId=localStorage.getItem("userId");var t=this.$store.state.getTreeId.treeId;t.id&&t.id.includes("s")&&(this.stationId=t.id.slice(1,t.id.length),this.stationId&&this.getTableList(1))},watch:{getStateData:function(t){var e=this.$store.state.getTreeId.treeId;e.id&&e.id.includes("s")&&(this.stationId=e.id.slice(1,e.id.length),this.stationId&&this.getTableList(1))}},computed:{getStateData:function(){return this.$store.state.getTreeId.treeId}},methods:{getTableList:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e){var r,a,i,n,s,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingOpen(),r={stationId:this.stationId,pageNo:e,pageSize:10},t.next=4,this.axios("/pvams/component/query",{params:r});case 4:a=t.sent,i=a.data,i=void 0===i?{}:i,i.code,n=i.data,n=void 0===n?{}:n,s=n.resultList,o=void 0===s?[]:s,this.loadingClose(),this.tableList=o;case 12:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),clickConfirm:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e,r){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.collarForm={num:"",action:r,id:e.id},this.isShowDialog=!0;case 2:case"end":return t.stop()}},t,this)}));function e(e,r){return t.apply(this,arguments)}return e}(),clickCollarConfirm:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e){var r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$refs[e].validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e){var a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=7;break}return a=Object(n["a"])({},r.collarForm,{stationId:r.stationId,userId:r.userId}),t.next=4,r.axios.post("/pvams/component/action",a);case 4:i=t.sent,s=i.data.code,200===s&&(r.getTableList(r.pageSize1),r.$message({type:"success",message:"".concat(0===r.collarForm.action?"领取":"入库","成功")}),r.isShowDialog=!1);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),close:function(t){this.collarForm={},this.$refs.collarForm&&this.$refs.collarForm.resetFields()},clickRecord:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e,r){var a,i,n,s,o,l,c,u,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.recordId=e.id,this.isVisibleQuery=!0,a={userId:this.userId,componentId:e.id,pageNo:r,pageSize:10},t.next=5,this.axios("/pvams/component/queryRecord",{params:a});case 5:i=t.sent,n=i.data,n=void 0===n?{}:n,s=n.code,o=n.data,o=void 0===o?{}:o,l=o.resultList,c=void 0===l?[]:l,u=o.count,d=void 0===u?0:u,200===s&&(this.recordDataList=c,this.recordTotal=d);case 12:case"end":return t.stop()}},t,this)}));function e(e,r){return t.apply(this,arguments)}return e}(),clickQueryConfirm:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e,r){var a,i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a={id:e.id,status:r,userId:this.userId},t.next=3,this.axios("/pvams/component/confirm",{params:a});case 3:i=t.sent,n=i.data.code,s=void 0===n?0:n,200===s&&(this.getTableList(this.pageSize1),this.clickRecord({id:this.recordId},this.pageSize2));case 7:case"end":return t.stop()}},t,this)}));function e(e,r){return t.apply(this,arguments)}return e}(),handleCurrentChange:function(t,e){1===e?(this.pageSize1=t,this.getTableList(t)):2===e&&(this.pageSize2=t,this.clickRecord({id:this.recordId},t))},uploadSuccess:function(t){200===t.code?(this.$message({type:"success",message:"上传成功"}),this.getTableList(this.pageSize1)):this.$message({type:"error",message:t.message})},beforeAvatarUpload:function(t){var e=t.size/1024/1024<20;return e||this.$message.error("上传文件大小不得超过20mb!"),e}}},c=l,u=r("2877"),d=Object(u["a"])(c,a,i,!1,null,"5924b340",null);e["default"]=d.exports}}]);
//# sourceMappingURL=sparePart.00095255.js.map