(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fireEquipmentMn"],{"68e9":function(e,t,i){"use strict";var r=i("cf12"),a=i.n(r);a.a},"7ffa":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fire-equipment"},[i("div",{staticClass:"main-content-end"},[i("a",{attrs:{href:"/pvams/fire/export/"+e.stationId}},[i("el-button",{attrs:{type:"",size:"small"}},[e._v("导出模板")])],1),e.getUserJurisdiction("AT17")?i("el-upload",{staticClass:"upload-demo",style:{marginLeft:"20px"},attrs:{action:"/pvams/fire/import/"+e.stationId,"on-success":function(t){return e.uploadSuccess(t)},"show-file-list":!1,"before-upload":function(t){return e.beforeAvatarUpload(t)}}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("导入信息")])],1):e._e()],1),i("div",{staticClass:"table",style:{marginTop:"20px"}},[i("el-table",{attrs:{"header-cell-class-name":"table-th",data:e.tableList,border:"",stripe:""}},[e._l(e.columns,function(e,t){return i("el-table-column",{key:t,attrs:{align:"center",prop:e.prop,label:e.label,width:e.width}})}),i("el-table-column",{attrs:{label:"点检状态",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"status-sty",style:{color:0===t.row.checkStatus?"#FF1F4D":1===t.row.checkStatus?"#CAA668":2===t.row.checkStatus?"#008000":"#000"}},[i("i",{style:{backgroundColor:0===t.row.checkStatus?"#FF1F4D":1===t.row.checkStatus?"#CAA668":2===t.row.checkStatus?"#008000":"#000"}}),e._v(" "+e._s(0===t.row.checkStatus?"未点检":1===t.row.checkStatus?"未确认":"已完成"))])]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.checkStatus?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){return e.clickSingle(t.row)}}},[e._v("点检")]):e._e(),e.getUserJurisdiction("AT18")?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){return e.clickRecord(t.row,1)}}},[e._v("记录查询")]):e._e()]}}])})],2)],1),i("div",[i("el-pagination",{attrs:{align:"right",small:"","page-size":10,layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),i("div",{staticClass:"dialog"},[i("el-dialog",{attrs:{title:"消防器材点检单",visible:e.isVisbleSingle,width:"40%"},on:{"update:visible":function(t){e.isVisbleSingle=t},close:function(t){return e.closeSingle("formSingle")}}},[i("div",{staticClass:"main",style:{overflow:"hidden"}},[i("el-form",{ref:"formSingle",attrs:{model:e.formSingle,size:"small","label-width":"120px"}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"器材名称"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.fireName,callback:function(t){e.$set(e.formSingle,"fireName",t)},expression:"formSingle.fireName"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"位置","label-width":"80px"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.position,callback:function(t){e.$set(e.formSingle,"position",t)},expression:"formSingle.position"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"数量"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.num,callback:function(t){e.$set(e.formSingle,"num",t)},expression:"formSingle.num"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"类型","label-width":"80px"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.type,callback:function(t){e.$set(e.formSingle,"type",t)},expression:"formSingle.type"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"点检时间"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.checkTime,callback:function(t){e.$set(e.formSingle,"checkTime",t)},expression:"formSingle.checkTime"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"点检人","label-width":"80px"}},[i("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.realname,callback:function(t){e.realname=t},expression:"realname"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"点检过程",prop:"checkProcess",rules:[{required:!0,message:"请输入点检过程"}]}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:""},model:{value:e.formSingle.checkProcess,callback:function(t){e.$set(e.formSingle,"checkProcess",t)},expression:"formSingle.checkProcess"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"点检结果",prop:"checkResult",rules:[{required:!0,message:"请输入点检结果"}]}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:""},model:{value:e.formSingle.checkResult,callback:function(t){e.$set(e.formSingle,"checkResult",t)},expression:"formSingle.checkResult"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"下次点检日期",prop:"nextCheckTime",rules:[{required:!0,message:"请选择下次点检日期"}]}},[i("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd hh:mm:ss","value-format":"yyyy-MM-dd hh:mm:ss",placeholder:"选择日期时间"},model:{value:e.formSingle.nextCheckTime,callback:function(t){e.$set(e.formSingle,"nextCheckTime",t)},expression:"formSingle.nextCheckTime"}})],1)],1)],1)],1),i("div",{attrs:{slot:"footer",align:"center"},slot:"footer"},[i("el-button",{on:{click:function(t){e.isVisbleSingle=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.clickSingleConfirm("formSingle")}}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"记录查询",visible:e.isVisibleQuery,width:"62%"},on:{"update:visible":function(t){e.isVisibleQuery=t},close:e.close}},[i("div",{staticClass:"main"},[i("el-table",{attrs:{data:e.recordDataList,border:"",stripe:""}},[e._l(e.recordColumns,function(e,t){return i("el-table-column",{key:t,attrs:{align:"center",prop:e.prop,label:e.label,width:e.width}})}),i("el-table-column",{attrs:{label:"确认状态",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(0===t.row.confirmStatus?"未确认":"已确认")+"\n            ")]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{disabled:0!==t.row.confirmStatus,type:"primary",size:"small"},on:{click:function(i){return e.clickQueryConfirm(t.row)}}},[e._v("确认")])]}}])})],2)],1)])],1)])},a=[],s=i("cebc"),l=(i("96cf"),i("3b8d")),n=(i("6762"),i("2fdb"),i("c1df")),o=i.n(n),c=i("bfe6"),u={mixins:[c["a"]],data:function(){return{tableList:[],columns:[{label:"器材名称",width:"",prop:"fireName"},{label:"位置",width:"",prop:"position"},{label:"数量",width:"",prop:"num"},{label:"类型",width:"",prop:"type"},{label:"本次点检日期",width:"160px",prop:"checkTime"},{label:"参数",width:"",prop:"param"},{label:"点检校验计划",width:"200px",prop:"checkPlan"},{label:"下次点检日期",width:"160px",prop:"nextCheckTime"}],total:0,formSingle:{},isVisibleQuery:!1,recordDataList:[],recordColumns:[{label:"点检人",width:"",prop:"checker"},{label:"点检时间",width:"160px",prop:"checkTime"},{label:"确认人",width:"",prop:"confirmer"},{label:"下次点检时间",width:"160px",prop:"nextCheckTime"}],pageNo:1,recordId:"",userId:"",stationId:"",isVisbleSingle:!1,realname:""}},created:function(){this.userId=localStorage.getItem("userId"),this.realname=localStorage.getItem("realname");var e=this.$store.state.getTreeId.treeId;e.id&&e.id.includes("s")&&(this.stationId=e.id.slice(1,e.id.length),this.stationId&&this.getTableList(1))},watch:{getStateData:function(e){var t=this.$store.state.getTreeId.treeId;t.id&&t.id.includes("s")&&(this.stationId=t.id.slice(1,t.id.length),this.stationId&&this.getTableList(1))}},computed:{getStateData:function(){return this.$store.state.getTreeId.treeId}},methods:{getTableList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var i,r,a,s,l,n,o,c,u,d;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingOpen(),i={stationId:this.stationId,pageNo:t,pageSize:10},e.next=4,this.axios("/pvams/fire/query",{params:i});case 4:r=e.sent,a=r.data,a=void 0===a?{}:a,s=a.code,l=a.data,l=void 0===l?{}:l,n=l.page,n=void 0===n?{}:n,o=n.count,c=void 0===o?0:o,u=l.resultList,d=void 0===u?[]:u,this.loadingClose(),200===s&&(this.tableList=d,this.total=c);case 14:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),clickSingle:function(e){this.isVisbleSingle=!0,this.formSingle=Object(s["a"])({},e,{nextCheckTime:"",fireId:e.id,checkTime:o()(new Date).format("YYYY-MM-DD hh:mm:ss")})},handleCurrentChange:function(e){this.pageNo=e,this.getTableList(e)},clickQueryConfirm:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var i,r,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i={userId:this.userId,id:t.id,confirmStatus:1},e.next=3,this.axios("/pvams/fire/confirm",{params:i});case 3:r=e.sent,a=r.data,a=void 0===a?{}:a,s=a.code,200===s&&(this.clickRecord({id:this.recordId},1),this.getTableList(this.pageNo));case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),clickSingleConfirm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(i){var r,a,l,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!i){e.next=10;break}return t.formSingle.id=null,r=Object(s["a"])({},t.formSingle,{checkUserId:t.userId}),e.next=5,t.axios.post("/pvams/fire/check",r);case 5:a=e.sent,l=a.data,l=void 0===l?{}:l,n=l.code,200===n&&(t.$message({type:"success",message:"点检成功"}),t.getTableList(t.pageNo),t.isVisbleSingle=!1);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},close:function(){},clickRecord:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,i){var r,a,s,l,n,o,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.recordId=t.id,this.isVisibleQuery=!0,r={fireId:t.id,pageNo:i,pageSize:20},e.next=5,this.axios("/pvams/fire/queryRecord",{params:r});case 5:a=e.sent,s=a.data,s=void 0===s?{}:s,l=s.code,n=s.data,n=void 0===n?{}:n,o=n.resultList,c=void 0===o?[]:o,200===l&&(this.recordDataList=c);case 12:case"end":return e.stop()}},e,this)}));function t(t,i){return e.apply(this,arguments)}return t}(),closeSingle:function(e){this.$refs[e].resetFields()},uploadSuccess:function(e){200===e.code?(this.$message({type:"success",message:"上传成功"}),this.getTableList(this.pageNo)):this.$message({type:"error",message:e.message})},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传文件大小不得超过20mb!"),t}}},d=u,p=(i("68e9"),i("2877")),m=Object(p["a"])(d,r,a,!1,null,"42dc9bff",null);t["default"]=m.exports},cf12:function(e,t,i){}}]);
//# sourceMappingURL=fireEquipmentMn.13c779bb.js.map