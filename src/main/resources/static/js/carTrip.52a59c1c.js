(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["carTrip"],{"4df8":function(t,e,a){"use strict";var r=a("b9c1"),s=a.n(r);s.a},"860b":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"car-trip"},[a("div",{staticClass:"main-content-end"},[a("a",{attrs:{href:"/pvams/car/export/"+t.stationId}},[a("el-button",{attrs:{type:"",size:"small"}},[t._v("导出模板")])],1),t.getUserJurisdiction("AT25")?a("el-upload",{staticClass:"upload-demo",style:{marginLeft:"20px"},attrs:{action:"/pvams/car/import/"+t.stationId,"on-success":function(e){return t.uploadSuccess(e)},"show-file-list":!1,"before-upload":function(e){return t.beforeAvatarUpload(e)}}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("导入信息")])],1):t._e()],1),a("div",{staticClass:"table",style:{marginTop:"20px"}},[a("el-table",{attrs:{"header-cell-class-name":"table-th",data:t.tableList,border:"",stripe:""}},[t._l(t.columns,function(t,e){return a("el-table-column",{key:e,attrs:{align:"center",prop:t.prop,label:t.label,width:t.width}})}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(0===e.row.status?"在站":"外出"))])]}}])}),a("el-table-column",{attrs:{label:"借出确认",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(0===e.row.confirmStatus?"未确认":"已确认"))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return t.clickLend(e.row,1)}}},[t._v("借出")]):t._e(),1===e.row.status?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return t.clickLend(e.row,0)}}},[t._v("归还")]):t._e(),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return t.clickRecord(e.row,1)}}},[t._v("记录查询")])]}}])})],2)],1),a("div",[a("el-pagination",{attrs:{align:"right",small:"","page-size":20,layout:"prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{title:"记录查询",visible:t.isVisibleQuery,width:"62%"},on:{"update:visible":function(e){t.isVisibleQuery=e},close:t.close}},[a("div",{staticClass:"main"},[a("el-table",{attrs:{data:t.recordDataList,border:"",stripe:""}},[t._l(t.recordColumns,function(t,e){return a("el-table-column",{key:e,attrs:{align:"center",prop:t.prop,label:t.label,width:t.width}})}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(0===e.row.action?"归还":"借出")+"\n            ")]}}])}),a("el-table-column",{attrs:{label:"审核状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(0===e.row.confirmStatus?"未确认":"已确认")+"\n            ")]}}])}),t.getUserJurisdiction("AT26")?a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.confirmStatus?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.clickConfirm(e.row)}}},[t._v("确认")]):t._e()]}}],null,!1,1585559054)}):t._e()],2)],1)])],1)])},s=[],n=(a("96cf"),a("3b8d")),i=(a("6762"),a("2fdb"),a("bfe6")),o={mixins:[i["a"]],data:function(){return{tableList:[],columns:[{label:"车牌号",width:"",prop:"carNum"},{label:"负责人",width:"",prop:"header"},{label:"品牌",width:"",prop:"brand"},{label:"参数",width:"",prop:"param"}],pageNo:1,recordDataList:[],componentId:"",recordColumns:[{label:"申请人",width:"",prop:"applyer"},{label:"申请时间",width:"160px",prop:"submitDate"},{label:"审批人",width:"",prop:"approver"},{label:"审批时间",width:"160px",prop:"approveDate"}],isVisibleQuery:!1,total:0,realname:"",stationId:"",userId:""}},created:function(){this.userId=localStorage.getItem("userId"),this.realname=localStorage.getItem("realname");var t=this.$store.state.getTreeId.treeId;t.id&&t.id.includes("s")&&(this.stationId=t.id.slice(1,t.id.length),this.stationId&&this.getTableList(1))},watch:{getStateData:function(t){var e=this.$store.state.getTreeId.treeId;e.id&&e.id.includes("s")&&(this.stationId=e.id.slice(1,e.id.length),this.stationId&&this.getTableList(1))}},computed:{getStateData:function(){return this.$store.state.getTreeId.treeId}},methods:{getTableList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,r,s,n,i,o,l,c,u,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingOpen(),a={stationId:this.stationId,pageNo:e,pageSize:20},t.next=4,this.axios("/pvams/car/query",{params:a});case 4:r=t.sent,s=r.data,s=void 0===s?{}:s,n=s.code,i=s.data,i=void 0===i?{}:i,o=i.page,o=void 0===o?{}:o,l=o.count,c=void 0===l?0:l,u=i.resultList,d=void 0===u?[]:u,this.loadingClose(),200===n&&(this.tableList=d,this.total=c);case 14:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),clickLend:function(t,e){var a=this;this.$confirm("是否确认借出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function r(){var s,n,i,o;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return s={carId:t.id,action:e,submitUserId:a.userId},r.next=3,a.axios.post("/pvams/car/borrow",s);case 3:n=r.sent,i=n.data,i=void 0===i?{}:i,o=i.code,200===o&&(a.getTableList(a.pageNo),a.$message({type:"success",message:"操作成功"}));case 8:case"end":return r.stop()}},r)})))},close:function(){},clickConfirm:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,r,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a={userId:this.userId,id:e.id,confirmStatus:1},t.next=3,this.axios("/pvams/car/confirm",{params:a});case 3:r=t.sent,s=r.data.code,200===s&&(this.clickRecord({id:this.componentId},1),this.getTableList(this.pageNo));case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),clickRecord:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e,a){var r,s,n,i,o,l,c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.isVisibleQuery=!0,this.componentId=e.id,r={userId:this.userId,carId:e.id,pageNo:a,pageSize:20},t.next=5,this.axios("/pvams/car/queryRecord",{params:r});case 5:s=t.sent,n=s.data,n=void 0===n?{}:n,i=n.code,o=n.data,o=void 0===o?{}:o,l=o.resultList,c=void 0===l?[]:l,200===i&&(this.recordDataList=c);case 12:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}(),handleCurrentChange:function(t){this.pageNo=t,this.getTableList(t)},uploadSuccess:function(t){200===t.code?(this.$message({type:"success",message:"上传成功"}),this.getTableList(this.pageNo)):this.$message({type:"error",message:t.message})},beforeAvatarUpload:function(t){var e=t.size/1024/1024<20;return e||this.$message.error("上传文件大小不得超过20mb!"),e}}},l=o,c=(a("4df8"),a("2877")),u=Object(c["a"])(l,r,s,!1,null,"40d8f82c",null);e["default"]=u.exports},b9c1:function(t,e,a){}}]);
//# sourceMappingURL=carTrip.52a59c1c.js.map