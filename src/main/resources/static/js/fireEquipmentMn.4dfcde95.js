(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fireEquipmentMn"],{"7ffa":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fire-equipment"},[a("div",{staticClass:"main-content-end"},[a("a",{style:{marginRight:"10px"},attrs:{href:e.imgUplodaPath,target:"_blank"}},[e._v(e._s(e.imgUplodaName||""))]),a("el-upload",{staticClass:"upload-demo",style:{margin:"0 20px"},attrs:{action:"/pvams/fire/uploadFile/"+e.stationId,"on-success":function(t){return e.uploadSuccess(t,3)},"show-file-list":!1,"before-upload":function(t){return e.beforeAvatarUpload(t,3)}}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("导入分布图")])],1),a("a",{attrs:{href:"/pvams/fire/export/"+e.stationId}},[a("el-button",{attrs:{type:"",size:"small"}},[e._v("导出模板")])],1),e.getUserJurisdiction("AT17")?a("el-upload",{staticClass:"upload-demo",style:{marginLeft:"20px"},attrs:{action:"/pvams/fire/import/"+e.stationId,"on-success":function(t){return e.uploadSuccess(t,1)},"show-file-list":!1,"before-upload":function(t){return e.beforeAvatarUpload(t,1)}}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("导入信息")])],1):e._e()],1),a("div",{staticClass:"table",style:{marginTop:"20px"}},[a("el-table",{attrs:{"header-cell-class-name":"table-th",data:e.tableList,border:"",stripe:""}},[e._l(e.columns,function(e,t){return a("el-table-column",{key:t,attrs:{align:"center",prop:e.prop,label:e.label,width:e.width}})}),a("el-table-column",{attrs:{label:"点检状态",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"status-sty",style:{color:0===t.row.checkStatus?"#FF1F4D":1===t.row.checkStatus?"#CAA668":2===t.row.checkStatus?"#008000":"#000"}},[a("i",{style:{backgroundColor:0===t.row.checkStatus?"#FF1F4D":1===t.row.checkStatus?"#CAA668":2===t.row.checkStatus?"#008000":"#000"}}),e._v(" "+e._s(0===t.row.checkStatus?"未点检":1===t.row.checkStatus?"未确认":"已完成"))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.checkStatus?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.clickSingle(t.row)}}},[e._v("点检")]):e._e(),e.getUserJurisdiction("AT18")?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.clickRecord(t.row,1)}}},[e._v("记录查询")]):e._e()]}}])})],2)],1),a("div",[a("el-pagination",{attrs:{align:"right",small:"","page-size":10,layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{title:"消防器材点检单",visible:e.isVisbleSingle,width:"40%"},on:{"update:visible":function(t){e.isVisbleSingle=t},close:function(t){return e.closeSingle("formSingle")}}},[a("div",{staticClass:"main",style:{overflow:"hidden"}},[a("el-form",{ref:"formSingle",attrs:{model:e.formSingle,size:"small","label-width":"120px"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"器材名称"}},[a("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.fireName,callback:function(t){e.$set(e.formSingle,"fireName",t)},expression:"formSingle.fireName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"位置","label-width":"80px"}},[a("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.position,callback:function(t){e.$set(e.formSingle,"position",t)},expression:"formSingle.position"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数量"}},[a("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.num,callback:function(t){e.$set(e.formSingle,"num",t)},expression:"formSingle.num"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"类型","label-width":"80px"}},[a("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.type,callback:function(t){e.$set(e.formSingle,"type",t)},expression:"formSingle.type"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"点检时间"}},[a("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.formSingle.checkTime,callback:function(t){e.$set(e.formSingle,"checkTime",t)},expression:"formSingle.checkTime"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"点检人","label-width":"80px"}},[a("el-input",{attrs:{disabled:"",placeholder:""},model:{value:e.realname,callback:function(t){e.realname=t},expression:"realname"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"点检过程",prop:"checkProcess",rules:[{required:!0,message:"请输入点检过程"}]}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:""},model:{value:e.formSingle.checkProcess,callback:function(t){e.$set(e.formSingle,"checkProcess",t)},expression:"formSingle.checkProcess"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"点检结果",prop:"checkResult",rules:[{required:!0,message:"请输入点检结果"}]}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:""},model:{value:e.formSingle.checkResult,callback:function(t){e.$set(e.formSingle,"checkResult",t)},expression:"formSingle.checkResult"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"下次点检日期",prop:"nextCheckTime",rules:[{required:!0,message:"请选择下次点检日期"}]}},[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.formSingle.nextCheckTime,callback:function(t){e.$set(e.formSingle,"nextCheckTime",t)},expression:"formSingle.nextCheckTime"}})],1)],1)],1)],1),a("div",{attrs:{slot:"footer",align:"center"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isVisbleSingle=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.clickSingleConfirm("formSingle")}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"记录查询",visible:e.isVisibleQuery,width:"62%"},on:{"update:visible":function(t){e.isVisibleQuery=t},close:e.close}},[a("div",{staticClass:"main"},[a("el-table",{attrs:{data:e.recordDataList,border:"",stripe:""}},[e._l(e.recordColumns,function(e,t){return a("el-table-column",{key:t,attrs:{align:"center",prop:e.prop,label:e.label,width:e.width}})}),a("el-table-column",{attrs:{label:"确认状态",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(0===t.row.confirmStatus?"未确认":"已确认")+"\n            ")]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:0!==t.row.confirmStatus,type:"primary",size:"small"},on:{click:function(a){return e.clickQueryConfirm(t.row)}}},[e._v("确认")])]}}])})],2)],1)])],1)])},r=[],s=a("cebc"),l=(a("7f7f"),a("96cf"),a("3b8d")),n=(a("6762"),a("2fdb"),a("c1df")),o=a.n(n),c=a("bfe6"),u={mixins:[c["a"]],data:function(){return{tableList:[],columns:[{label:"器材名称",width:"",prop:"fireName"},{label:"位置",width:"",prop:"position"},{label:"数量",width:"",prop:"num"},{label:"类型",width:"",prop:"type"},{label:"本次点检日期",width:"160px",prop:"checkTime"},{label:"参数",width:"",prop:"param"},{label:"点检校验计划",width:"200px",prop:"checkPlan"},{label:"下次点检日期",width:"160px",prop:"nextCheckTime"}],total:0,imgUplodaPath:"",imgUplodaName:"",formSingle:{},isVisibleQuery:!1,recordDataList:[],recordColumns:[{label:"点检人",width:"",prop:"checker"},{label:"点检时间",width:"160px",prop:"checkTime"},{label:"确认人",width:"",prop:"confirmer"},{label:"下次点检时间",width:"160px",prop:"nextCheckTime"}],pageNo:1,recordId:"",userId:"",stationId:"",isVisbleSingle:!1,realname:""}},created:function(){this.userId=localStorage.getItem("userId"),this.realname=localStorage.getItem("realname");var e=this.$store.state.getTreeId.treeId;e.id&&e.id.includes("s")&&(this.stationId=e.id.slice(1,e.id.length),this.stationId&&this.getTableList(1))},watch:{getStateData:function(e){var t=this.$store.state.getTreeId.treeId;t.id&&t.id.includes("s")&&(this.stationId=t.id.slice(1,t.id.length),this.stationId&&this.getTableList(1))}},computed:{getStateData:function(){return this.$store.state.getTreeId.treeId}},methods:{getTableList:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,i,r,s,l,n,o,c,u,d,p,m,f,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingOpen(),a={stationId:this.stationId,pageNo:t,pageSize:10},e.next=4,this.axios("/pvams/fire/query",{params:a});case 4:i=e.sent,r=i.data,r=void 0===r?{}:r,s=r.code,l=r.data,l=void 0===l?{}:l,n=l.name,o=void 0===n?"":n,c=l.path,u=void 0===c?"":c,d=l.page,d=void 0===d?{}:d,p=d.count,m=void 0===p?0:p,f=l.resultList,h=void 0===f?[]:f,this.loadingClose(),200===s&&(this.imgUplodaName=o,this.imgUplodaPath=u,this.tableList=h,this.total=m);case 14:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),clickSingle:function(e){this.isVisbleSingle=!0,this.formSingle=Object(s["a"])({},e,{nextCheckTime:"",fireId:e.id,checkTime:o()(new Date).format("YYYY-MM-DD hh:mm:ss")})},handleCurrentChange:function(e){this.pageNo=e,this.getTableList(e)},clickQueryConfirm:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,i,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a={userId:this.userId,id:t.id,confirmStatus:1},e.next=3,this.axios("/pvams/fire/confirm",{params:a});case 3:i=e.sent,r=i.data,r=void 0===r?{}:r,s=r.code,200===s&&(this.clickRecord({id:this.recordId},1),this.getTableList(this.pageNo));case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),clickSingleConfirm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(a){var i,r,l,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=10;break}return t.formSingle.id=null,i=Object(s["a"])({},t.formSingle,{checkUserId:t.userId}),e.next=5,t.axios.post("/pvams/fire/check",i);case 5:r=e.sent,l=r.data,l=void 0===l?{}:l,n=l.code,200===n&&(t.$message({type:"success",message:"点检成功"}),t.getTableList(t.pageNo),t.isVisbleSingle=!1);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},close:function(){},clickRecord:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,a){var i,r,s,l,n,o,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.recordId=t.id,this.isVisibleQuery=!0,i={fireId:t.id,pageNo:a,pageSize:20},e.next=5,this.axios("/pvams/fire/queryRecord",{params:i});case 5:r=e.sent,s=r.data,s=void 0===s?{}:s,l=s.code,n=s.data,n=void 0===n?{}:n,o=n.resultList,c=void 0===o?[]:o,200===l&&(this.recordDataList=c);case 12:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),closeSingle:function(e){this.$refs[e].resetFields()},uploadSuccess:function(e,t){200===e.code?(this.$message({type:"success",message:"上传成功"}),3===t&&(this.imgUplodaName=e.data&&e.data.name,this.imgUplodaPath=e.data&&e.data.path),this.getTableList(this.pageNo)):this.$message({type:"error",message:e.message})},beforeAvatarUpload:function(e,t){if(1===t){var a=e.size/1024/1024<20;return a||this.$message.error("上传文件大小不得超过20mb!"),a}if(2===t)return!0;if(3===t){var i=e.size/1024/1024<20,r="image/jpeg"===e.type||"image/png"===e.type;return r||this.$message.error("上传头像图片只能是 JPG或者Png 格式!"),i||this.$message.error("上传大小不得超过10mb!"),r&&i}}}},d=u,p=(a("8b91"),a("2877")),m=Object(p["a"])(d,i,r,!1,null,"615d886d",null);t["default"]=m.exports},"8b91":function(e,t,a){"use strict";var i=a("945b"),r=a.n(i);r.a},"945b":function(e,t,a){}}]);
//# sourceMappingURL=fireEquipmentMn.4dfcde95.js.map